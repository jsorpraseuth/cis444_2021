<!DOCTYPE html>
<html>
    <head>
		<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
		<style>
			body {
				background: linear-gradient(-45deg, #120C6E, #5E72EB, #FF9190, #FDC094);
				background-size: 800% 800%;
				animation: gradient 15s ease infinite;
			}

			@keyframes gradient {
				0% {
					background-position: 0% 50%;
				}
				50% {
					background-position: 100% 50%;
				}
				100% {
					background-position: 0% 50%;
				}
			}

			.login {
				border: 1px solid grey;
				background: white;
				margin-left: auto;
				margin-right: auto;
				margin-top: 200px;
				width: 400px;
				height: 250px;
				text-align: center;
				font-family: Roboto Light;
				box-shadow: 5px 5px 10px rgba(0, 0, 0, .5);
			}

			.formLabel {
				display: inline-block;
				float: left;
				margin-left: 55px;
				padding: 2px;
			}

			.formInput {
				display: inline-block;
				float: middle;
				width: 70%;
				padding: 3px;
			}

			.btn {
				background-color: light grey;
				color: black;
				border: 1px solid black;
				padding: 6px 24px;
				display: inline-block;
				text-align: center;
				text-decoration: none;
			}

			h1 { 
				font-size: 17px;
			}
			
			.store {
				display: none;
			}
		</style>
    </head>
    <body>
		<script>
			var token;
			
			async function loggedIn() {		
				const response = await $.post("/verify", { "username": document.getElementById("username").value, "password": document.getElementById("password").value }, "json");
				
				if (Response.status == 200) {
					token = await response.data;
					getBooks();
					$(".login").hide();
					$(".store").show();
				}
				
				document.getElementById("username").value = "";
				document.getElementById("password").value = "";
				return true;
			}
			
			async function getBooks() {
				const response = await $.post("/getBooks", { "jwt": token.jwt }, "json");
				for(i = 0; i < response.data.books.length; i++) {
					document.getElementById("books").innerHTML += response.data.books[i].book_name + '<br>'
						+ response.data.books[i].book_author + '<br>'
						+ response.data.books[i].book_genre + '<br>'
						+ response.data.books[i].book_price
						+ '<button id="' + response.data.books[i].book_id + '" onclick="buyBook(this.id);">Buy</button>';
				}
			}
			
			async function buyBook(id) {}
			
			function logout() {
				fetch("/logout");
				token = undefined;
				$(".login").show();
				$(".store").hide();
			}
			
		</script>
		
		<div class="store">
			<button type="submit" class="btn" onclick="logout()">Log Out</button>
		
			<h1>If this shows that means you're logged in!</h1>
			<div class="books"></div>
		</div>
		
		<div class="login">
			<h1>Please log into your account to view the store.</h1>
			<form action="/verify" method="POST">
				<label class="formLabel" for="username">Username:</label>
				<input class="formInput" type="text" id="username" name="username" placeholder="Username" required><br>
				
				<label class="formLabel" for="password">Password:</label>
				<input class="formInput" type="password" id="password" name="password" placeholder="Password" required><br><br>
				
				<button type="submit" class="btn" formaction="/create" method="GET">Register</button>
				<button type="submit" class="btn" onclick="loggedIn()">Log In</button>
			</form>
			<p>{{verification}}</p>
		</div>
		
    </body>
</html>
